<app-modal 
  [isOpen]="isOpen"
  title="Sign In to Your Account"
  size="sm"
  [showFooter]="false"
  (close)="close.emit()"
>
  <div class="auth-content">
    <app-alert 
      *ngIf="authError" 
      variant="error" 
      [dismissible]="true"
      (dismiss)="authError = ''"
    >
      {{ authError }}
    </app-alert>

    <!-- Email Step -->
    <div *ngIf="currentStep === 'email'" class="auth-step">
      <div class="auth-description">
        <p>Enter your email address to receive a secure sign-in link.</p>
      </div>

      <form (ngSubmit)="onSubmitEmail()" class="auth-form">
        <app-input
          label="Email Address"
          type="email"
          placeholder="Enter your email address"
          prefixIcon="email"
          [value]="email"
          [disabled]="isLoading"
          [required]="true"
          (inputChange)="email = $event"
        ></app-input>

        <app-button 
          type="submit"
          variant="primary" 
          [fullWidth]="true"
          [loading]="isLoading"
          [disabled]="!email.trim()"
        >
          {{ isLoading ? 'Sending...' : 'Send Sign-In Link' }}
        </app-button>
      </form>
    </div>

    <!-- Email Sent Step -->
    <div *ngIf="currentStep === 'email-sent'" class="auth-step">
      <div class="auth-description">
        <div class="success-icon">
          <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
            <polyline points="22,6 12,13 2,6"/>
          </svg>
        </div>
        <h3>Check Your Email</h3>
        <p>We've sent a secure sign-in link to <strong>{{ email }}</strong></p>
        <p class="text-muted">Click the link in your email to sign in. The link will expire in 15 minutes.</p>
      </div>

      <!-- Mock Login Button (only shown when mock backend is enabled) -->
      <div *ngIf="isMockBackendEnabled" class="mock-login-section">
        <div class="mock-divider">
          <span>Development Mode</span>
        </div>
        <app-button 
          variant="success" 
          [fullWidth]="true"
          [loading]="isMockLoggingIn"
          (click)="onMockLogin()"
        >
          {{ isMockLoggingIn ? 'Signing In...' : 'Mock Login (Dev Only)' }}
        </app-button>
        <p class="mock-help-text">This button is only available in development mode</p>
      </div>

      <div class="form-actions">
        <button type="button" class="link-button" (click)="onBackToEmail()">
          Use Different Email
        </button>
        <button type="button" class="link-button" (click)="onResendEmail()" [disabled]="isLoading">
          Resend Email
        </button>
      </div>
    </div>

    <div class="auth-footer">
      <p class="text-muted">
        By signing in, you agree to our Terms of Service and Privacy Policy.
      </p>
    </div>
  </div>
</app-modal>