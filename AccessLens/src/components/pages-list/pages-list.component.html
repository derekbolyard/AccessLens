<div class="pages-list" *ngIf="site">
  <div class="container">
    <div class="pages-header">
      <div class="breadcrumb">
        <button class="breadcrumb-link" (click)="onBackToSites()">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="15,18 9,12 15,6"/>
          </svg>
          All Sites
        </button>
        <span class="breadcrumb-separator">/</span>
        <span class="breadcrumb-current">{{ site.name }}</span>
      </div>
      
      <div class="site-overview">
        <h2>{{ site.name }}</h2>
        <div class="site-meta">
          <span class="site-url">{{ site.url }}</span>
          <span class="last-scan">Last scan {{ formatDate(site.lastScanDate) }}</span>
        </div>
      </div>
    </div>

    <div class="site-stats-grid">
      <div class="stat-card card">
        <div class="stat-icon info">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
            <polyline points="14,2 14,8 20,8"/>
          </svg>
        </div>
        <div class="stat-content">
          <div class="stat-number">{{ getSiteTotalPages() }}</div>
          <div class="stat-label">Pages Scanned</div>
        </div>
      </div>

      <div class="stat-card card">
        <div class="stat-icon error">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <line x1="15" y1="9" x2="9" y2="15"/>
            <line x1="9" y1="9" x2="15" y2="15"/>
          </svg>
        </div>
        <div class="stat-content">
          <div class="stat-number">{{ getSiteTotalPendingIssues() }}</div>
          <div class="stat-label">Pending Issues</div>
        </div>
      </div>

      <div class="stat-card card">
        <div class="stat-icon success">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="20,6 9,17 4,12"/>
          </svg>
        </div>
        <div class="stat-content">
          <div class="stat-number">{{ getSiteTotalFixedIssues() }}</div>
          <div class="stat-label">Fixed Issues</div>
        </div>
      </div>

      <div class="stat-card card">
        <div class="stat-icon">
          <div class="score-circle" [class]="getScoreClass(getSiteAverageScore())">
            <span class="score-value">{{ getSiteAverageScore() }}%</span>
          </div>
        </div>
        <div class="stat-content">
          <div class="stat-number">{{ getSiteAverageScore() }}%</div>
          <div class="stat-label">Average Score</div>
        </div>
      </div>
    </div>

    <div class="pages-section">
      <h3>Pages</h3>
      <div class="pages-grid">
        <div 
          *ngFor="let page of allPagesForSite(); trackBy: trackByPageId" 
          class="page-card card fade-in"
          (click)="onPageClick(page)"
          [class.loading]="page.status === 'in-progress'"
        >
          <div class="page-header">
            <div class="page-info">
              <h4>{{ page.title }}</h4>
              <span class="page-url">{{ page.url }}</span>
            </div>
            <div class="page-status">
              <span class="badge" 
                    [class.badge-success]="page.status === 'completed'"
                    [class.badge-warning]="page.status === 'in-progress'"
                    [class.badge-error]="page.status === 'failed'">
                {{ getStatusLabel(page.status) }}
              </span>
            </div>
          </div>

          <div class="page-metrics" *ngIf="page.status === 'completed'">
            <div class="score-section">
              <div class="score-bar">
                <div class="score-fill" [style.width.%]="page.score"></div>
              </div>
              <span class="score-text">{{ page.score }}% Score</span>
            </div>

            <div class="issues-summary">
              <div class="issue-stat">
                <span class="issue-count error">{{ page.totalIssues - page.fixedIssues - page.ignoredIssues }}</span>
                <span class="issue-label">Pending</span>
              </div>
              <div class="issue-stat">
                <span class="issue-count success">{{ page.fixedIssues }}</span>
                <span class="issue-label">Fixed</span>
              </div>
              <div class="issue-stat">
                <span class="issue-count muted">{{ page.ignoredIssues }}</span>
                <span class="issue-label">Ignored</span>
              </div>
            </div>
          </div>

          <div class="page-footer">
            <span class="scan-date text-muted">
              Scanned {{ formatDate(page.scanDate) }}
            </span>
            <div class="page-actions">
              <button class="btn btn-secondary btn-sm" (click)="onViewPage(page, $event)">
                View Issues
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>