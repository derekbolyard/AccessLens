<div class="pages-list" *ngIf="site">
  <div class="container">
    <!-- Enhanced Breadcrumb Navigation -->
    <app-breadcrumb [items]="breadcrumbItems"></app-breadcrumb>

    <!-- Enhanced Page Context -->
    <app-page-context 
      [context]="{
        title: 'Pages for ' + site.name,
        subtitle: 'Individual page accessibility results',
        icon: 'pages',
        stats: [
          { label: 'Pages', value: getSiteTotalPages(), variant: 'default' },
          { label: 'Pending', value: getSiteTotalPendingIssues(), variant: 'error' },
          { label: 'Fixed', value: getSiteTotalFixedIssues(), variant: 'success' },
          { label: 'Avg Score', value: getSiteAverageScore() + '%', variant: getSiteAverageScore() >= 80 ? 'success' : 'warning' }
        ]
      }"
    ></app-page-context>

    <!-- Loading State -->
    <div *ngIf="isLoading" class="loading-container">
      <app-loading type="skeleton" [skeletonLines]="3" text="Loading pages..."></app-loading>
    </div>

    <!-- Empty State -->
    <div *ngIf="!isLoading && allPagesForSite().length === 0" class="empty-state">
      <app-card [elevated]="true" class="empty-state-card">
        <div class="empty-state-content">
          <div class="empty-state-icon">
            <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
            </svg>
          </div>
          <h3>No Pages Found</h3>
          <p>This report doesn't have any pages yet. The scan might still be in progress or may have failed.</p>
          <button class="back-to-reports-btn" (click)="onBackToReports()">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="15,18 9,12 15,6"/>
            </svg>
            Back to Reports
          </button>
        </div>
      </app-card>
    </div>

    <!-- Pages Section -->
    <div *ngIf="!isLoading && allPagesForSite().length > 0" class="pages-section">
      <h3>Pages</h3>
      
      <div class="pages-list">
        <div 
          *ngFor="let page of allPagesForSite(); trackBy: trackByPageId" 
          class="page-item"
          [class.loading]="page.status === 'in-progress'"
          (click)="onPageClick(page)"
        >
          <div class="page-main">
            <div class="page-info">
              <div class="page-header">
                <h4>{{ page.title }}</h4>
                <app-badge 
                  [variant]="getStatusVariant(page.status)"
                  [icon]="getStatusIcon(page.status)"
                >
                  {{ getStatusLabel(page.status) }}
                </app-badge>
              </div>
              <div class="page-meta">
                <span class="page-url">{{ page.url }}</span>
                <span class="scan-date">Scanned {{ formatDate(page.scanDate) }}</span>
              </div>
            </div>

            <div class="page-metrics" *ngIf="page.status === 'completed'">
              <div class="score-display">
                <div class="score-bar">
                  <div class="score-fill" [style.width.%]="page.score"></div>
                </div>
                <span class="score-text">{{ page.score }}%</span>
              </div>

              <div class="issues-inline">
                <span class="issue-stat error">{{ page.totalIssues - page.fixedIssues - page.ignoredIssues }} pending</span>
                <span class="issue-stat success">{{ page.fixedIssues }} fixed</span>
                <span class="issue-stat muted">{{ page.ignoredIssues }} ignored</span>
              </div>
            </div>
          </div>

          <div class="page-action">
            <button 
              class="view-issues-btn"
              [disabled]="page.status !== 'completed'"
              (click)="onViewPage(page, $event)"
            >
              View Issues
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>